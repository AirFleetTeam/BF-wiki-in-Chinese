# Betaflight 4.1

## Betaflight 4.1带来了

* 更简化的RPM滤波器配置
* 改进低通滤波器默认设置
* 动态陷波滤波器更新
* 前馈插值，以削弱前馈信号中的尖峰
* 前馈增强 to improve transient stick response and reduce overshoot
* 前馈限制，用以防止高角速率旋转时产生的过冲
* 优化的PID和TPA默认值，在新的配置程序中增加调参滑块

Beatflight 4.1显著改善了滤波器默认参数、PID和前馈功能，所有这些改动都有助于令你的飞机表现得比以往更好，并且开箱即用。我们还有一个全新的10.6配置器！

默认设置可以在绝大多数飞机上表现得十分优秀，包括那些刷4.0.x固件之后出现问题了的飞机。在小无刷和7寸甚至更大的飞机上，可能需要对默认参数做一些调整，但我们强烈建议绝大多数飞机首先尝试使用默认参数进行飞行。

#### 注意1：请勿将先前任何版本的diff内容粘贴到4.1的CLI中。4.0.x的diff也不行！这样会带来非常不合适的设置！

#### 注意2：请先从默认滤波器和PID开始，除非您十分确定您的飞行器确实需要一些并不常见的设置。默认PID真的非常非常优秀！

现在，4.1中的低通滤波器类型全部都是PT1。它们已经针对低延迟方向进行了配置优化，并降低起飞暴走的概率。它们非常有效，但对于部分情况较好的飞机来说，滤波强度可能过高了。配置程序10.6.0中提供了一种较为简单的降低滤波延迟的手段。

我们强烈建议启用RPM滤波器。现在它比之前更易使用了。RPM滤波几乎完全消除了PID回路中由电机产生的噪声。然后，动态陷波器寻找并去除剩余的任何共振噪声。然后，低通滤波器则只剩下很少的工作了。作为一组截止频率可以移动提升至1.5-2倍于正常截止频率的滤波器，它可以以相同的比例来减少滤波器延迟，从而比以往更好地处理洗桨。新的前馈功能将在后面 做详细介绍，但默认值非常稳定，不需要任何调整。

在大多数情况下，4.1应该是一个“刷完就去飞”的版本，默认参数在各种情况下工作十分良好。

如果您的图传受飞控控制，那么您需要自行配置一个合适的图传表，以符合当地的法律法规。

Bitbanged Dshot仍然是一种较新的协议，请在RC阶段到GitHub代码仓库汇报错误。如果你的电调出现了一点小问题，请尝试使用`set dshot_bitbang = OFF` 而不是保持默认设置。更多信息请参阅《双向Dshot和RPM滤波》。

### 进一步简化的RPM滤波配置

现在，启用基于RPM回传数据的陷波滤波器\(组\)比以往更容易了。默认情况下`dshot_bitbang= AUTO`，无需再在部分F4和F7飞控上自行修改定时器和DMA资源。当双向Dshot启用后，RPM回传将被自动激活，这可以在10.6配置器中手动完成。旧的电调固件则需要关闭dshot\_bitbang`set dshot_bitbang = OFF`。更多相关信息，请参阅最新的《双向Dshot和RPM滤波》。

我们建议在启用RPM滤波器之后仍启用动态陷波滤波器。有关如何在激活RPM滤波器之后调整其余滤波器，请参阅下一节。

